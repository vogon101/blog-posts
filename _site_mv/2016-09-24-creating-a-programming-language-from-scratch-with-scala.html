<p>It has always been a dream of mine to create my own programming language, however useless. I have tried this a few times (see <a href="https://github.com/vogon101/SLang">Slang</a> and <a href="https://github.com/vogon101/SLang">Slang2</a>) however these aren’t really any good at all. The first one had no type system and was purely procedural and the second had some types but they are badly implemented and don’t really work. With this experience behind me, I have decided to start again, from the ground up. This time a few things will be different:</p>

<!-- more -->

<ul>
  <li>I will be writing my own parsing code and not using the Scala parser combinators</li>
  <li>I will design the language around the type system and not the other way round
    <ul>
      <li>This <em>should</em> prevent me getting stuck somewhere down the road with a malfunctioning type system that needs to be completely rewritten</li>
    </ul>
  </li>
</ul>

<p>This language will be for embedding in JVM applications, imagine LUA but inspired by java or Scala. This could be used for games (ie mods), an office suite (ie macros) or any other application that needs to allow the user to access a limited set of functions and needs to allow them to control these programmatically. I am using Scala because I love the language and it gives me interoperability with Java.</p>

<h2 id="the-language-basics">The language basics</h2>

<p>The language will draw inspiration from a number of sources.</p>

<p>At a high level, the language will have the following principles:</p>

<ul>
  <li>It will be interpreted, not compiled</li>
  <li>The type system will be based on Java’s syntactically but behind the scenes the implementation will be like Javascript’s, prototype based</li>
  <li>Functions and types will simply be objects, assigned to variables</li>
  <li>Syntactically the language will be a cross between Java/C#, scala and my own imagination</li>
</ul>

<h2 id="an-example">An Example</h2>

<p>Here is some example code in the new language, obviously the language may change:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Person</span> <span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">yearOfBirth</span><span class="o">)</span> <span class="o">{</span>

	<span class="k">this</span><span class="o">.</span><span class="n">age</span> <span class="k">=</span> <span class="o">()</span> <span class="k">=&gt;</span>  <span class="n">currentYear</span> <span class="o">-</span> <span class="n">yearOfBirth</span><span class="o">;</span>

	<span class="k">this</span><span class="o">.</span><span class="n">apply</span> <span class="k">=</span> <span class="o">()</span> <span class="k">=&gt;</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">"Person ("</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">")"</span>
	<span class="o">}</span>

	<span class="c1">//Yes I know this is a stupid function but who cares
</span>	<span class="k">this</span><span class="o">.+</span> <span class="k">=</span> <span class="o">(</span><span class="n">years</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">yearOfBirth</span><span class="o">+</span><span class="n">years</span><span class="o">)</span>
	<span class="o">}</span>

	<span class="k">this</span><span class="o">.+=</span> <span class="k">=</span> <span class="o">(</span><span class="n">years</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="n">yearOfBirth</span> <span class="k">=</span> <span class="k">this</span><span class="o">.</span><span class="n">yearOfBirth</span> <span class="o">+</span> <span class="n">years</span>
	<span class="o">}</span>

<span class="o">}</span>

<span class="n">currentYear</span> <span class="k">=</span> <span class="mi">2016</span>
<span class="n">freddie</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="s">"Freddie"</span><span class="o">,</span> <span class="mi">2000</span><span class="o">)</span>

<span class="n">println</span><span class="o">(</span><span class="n">freddie</span><span class="o">.</span><span class="n">age</span><span class="o">())</span> <span class="c1">//Prints 4
</span><span class="n">println</span><span class="o">(</span><span class="n">freddie</span><span class="o">())</span> <span class="c1">//Prints "Person (Freddie)"
</span>
<span class="n">freddie</span><span class="o">.</span><span class="n">name</span> <span class="k">=</span> <span class="s">"Freddie Poser"</span>
<span class="n">println</span><span class="o">(</span><span class="n">freddie</span><span class="o">())</span> <span class="c1">// Prints "Person (Freddie Poser)"
</span>
<span class="n">newFreddie</span> <span class="k">=</span> <span class="n">freddie</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">println</span><span class="o">(</span><span class="n">freddie</span><span class="o">.</span><span class="n">yearOfBirth</span><span class="o">)</span> <span class="c1">//Prints 2000
</span><span class="n">println</span><span class="o">(</span><span class="n">newFreddie</span><span class="o">.</span><span class="n">yearOfBirth</span><span class="o">)</span> <span class="c1">//Prints 2001
</span>
<span class="n">freddie</span> <span class="o">+=</span> <span class="mi">2</span>
<span class="n">println</span><span class="o">(</span><span class="n">freddie</span><span class="o">.</span><span class="n">yearOfBirth</span><span class="o">)</span> <span class="c1">//prints 2002
</span><span class="n">println</span><span class="o">(</span><span class="n">newFreddie</span><span class="o">.</span><span class="n">yearOfBirth</span><span class="o">)</span> <span class="c1">//Prints 2001
</span></code></pre>
</div>

<p>Here we can see a couple of things about the proposed language:</p>

<ul>
  <li>The body of the class is the constructor, just like in scala
    <ul>
      <li>Unlike scala however, functions are simply assigned to variable members of <code class="highlighter-rouge">this</code> object
        <ul>
          <li>This is a bit like javascript and makes it easier to implemented</li>
        </ul>
      </li>
      <li>Arguments to the constructor are defined just after the class name</li>
    </ul>
  </li>
  <li>Functions can access the scope of the caller (see currentYear)
    <ul>
      <li>This makes the language easier for beginners</li>
      <li>This also might be changed later, depending on how I feel because this seems wrong</li>
    </ul>
  </li>
  <li>All members are public - this is like python or Javascript
    <ul>
      <li>This is a dynamic language, <code class="highlighter-rouge">private</code> or <code class="highlighter-rouge">protected</code> doesn’t really make sense in this</li>
    </ul>
  </li>
  <li>Objects can be called like functions using the apply method
    <ul>
      <li>This is borrowed from scala</li>
      <li>It is included because I like it and means we don’t have to parse special conditions for list access
        <ul>
          <li>See Scala’s list</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Functions are defined with the <code class="highlighter-rouge">(&lt;arguments&gt;) =&gt; &lt;code&gt;</code> and simply assigned to variables
    <ul>
      <li>Because they are just objects they can be passed to functions like so: <code class="highlighter-rouge">higherOrderFunction ( (arg) =&gt; println(arg) )</code></li>
    </ul>
  </li>
  <li>Semicolons are optional</li>
  <li>Everything is an expression that can return a value</li>
  <li>Functions return the value of their last line if there is no <code class="highlighter-rouge">return</code> statement</li>
</ul>

<h2 id="final-thoughts">Final Thoughts</h2>
<p>This language is for embedding in the JVM and so is not a full, static, compiled language. It is designed for fast prototyping and to be easy. There are plenty of aspects in this that I would change if this was a real language, but the design decisions above make the implementation easier and make it simpler for the users.</p>

